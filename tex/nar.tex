 \tikzstyle{texto} = [above, 
 					  text width=6em, 
                      text centered,
                      font=\normalsize]

\tikzstyle{start} = [rectangle,
                     minimum size=6mm,%rounded corners=3mm,
					 very thick,
                     draw = black!50, 
                     top color = white,
                     bottom color = black!20,
                     font=\itshape\footnotesize,
                     drop shadow, 
                     align=center]
                     
\tikzstyle{fail} = [rectangle, 
					rounded corners, 
                    minimum width=3cm, 
                    minimum height=1cm,
                    text centered,
                    font=\itshape\footnotesize, 
                    draw=black, 
                    fill=red, 
                    text=white,  
                    drop shadow]
                    
\tikzstyle{success} = [rectangle, 
					   rounded corners, 
                       minimum width=3cm, 
                       font=\itshape\footnotesize,
                       minimum height=1cm,
                       text centered, 
                       draw=black,
                       fill=green!70!black!70, 
                       text=white,  
                       drop shadow]
\tikzstyle{process} = [rectangle, 
					   minimum width=1cm, 
                       minimum height=0.5cm, 
                       text centered, 
                       text width=3cm, 
                       font=\itshape\footnotesize,
                       draw=black, 
                       fill=black!40, 
                       text=white,drop shadow]
\tikzstyle{decision} = [diamond, 
						minimum width=0.5cm, 
                        minimum height=0.5cm,
                        font=\itshape\footnotesize,
						text centered, 
                        draw=black,
						top color = white,
                        bottom color = yellow!80, 
                        text=black, 
                        drop shadow]
                        
\tikzstyle{arrow} = [thick,->,>=stealth,-latex',draw,rounded corners]
\tikzstyle{cloud} = [draw, 
					 ellipse,
					 rounded corners = 3mm,
                     very thick,
                     draw           = orange!50, 
                     top color      = white,
                     bottom color   = orange!20,
                     font           = \itshape\footnotesize,
                     node distance  = 4cm,
                     minimum height = 1em,
                     drop shadow]


\begin{figure}[!h]
 \begin{center}
 \begin{tikzpicture}[node distance = 1.5cm, 
 					 auto, shorten >=1pt,
                     thick,font=\itshape\footnotesize,
                     ->,
                     >=stealth']
 \linespread{0.8}{

 \node (clinic) [start]{TCGAquery\_clinic};
 \node (start) [start, below of=clinic,yshift=0.5cm] {TCGAquery};
 \node (download) [start, below of=start,yshift=0.5cm] {TCGAdownload};
 \node (prepare) [start, below of=download,yshift=0.5cm] {TCGAprepare};
 \node (version) [start, below of=prepare,yshift=0.5cm] { TCGAquery\_version};

 \node (coxnet) [start, right of=clinic, yshift=0cm,xshift = +1.5cm] {survivalCoxNET};
 \node (survival) [start, right of=start, yshift=0cm,xshift = +1.5cm] {survival};
 \node (eacomplete) [start, right of=download, yshift = 0cm,xshift = +1.5cm] {EAcomplete};
 \node (eabarplot) [start, right of=eacomplete, xshift = +1cm] {EAbarplot};
 \node (dea) [start, right of=prepare,yshift = 0cm, xshift = +1.5cm] {DEA};
 \node (dmr) [start, right of=version, xshift = +1.5cm,yshift = 0cm] {DMR};

 \node (starburst) [start, right of=dmr, xshift = 1cm,yshift = 0.3cm] {starburst};

 \tikzstyle{texto} = [above, text width=6em, text centered,font=\normalsize]

 \path [arrow] (start) -- (download);
 \path [arrow] (download) -- (prepare);
 \path [arrow] (prepare) -- (eacomplete);
 \path [arrow] (eacomplete) -- (eabarplot);
 \path [arrow] (prepare) -- (dea);
 \path [arrow] (prepare) -- (dmr);
 \path [arrow] (dmr) -- (starburst);
 \path [arrow] (dea) -- (starburst);
 \draw (prepare) edge[out=0,in=180,->,color=red!80!black] (dmr);
 \draw (prepare) edge[out=0,in=180,->,color=green!60!black] (dea);
 \draw (prepare) edge[out=0,in=200,->,color=green!60!black] (eacomplete);
 \draw (prepare) edge[out=0,in=180,->,color=green!60!black] (coxnet);
 \draw (clinic) edge[out=0,in=180,->,color=blue!80!black] (coxnet);
 \draw (clinic) edge[out=0,in=180,->,color=blue!80!black] (survival);
 \path [arrow,color=blue!80!black] (clinic) -- (survival);

 }
 % Background
 \begin{pgfonlayer}{background}
   \begin{pgfonlayer}{background}
         % Compute a few helper coordinates
         \path (start.west |- start.north)+(-0.5,0.5) node (a) {};
		 \path (prepare.south -| prepare.east)+(+0.3,-0.2) node (b) {};
		 \path (clinic.west |- clinic.north)+(-0.5,0.6) node (a) {};
         \path (dmr.south -| prepare.east)+(+0.3,-0.2) node (b) {};
         \path (starburst.south -| eabarplot.east)+(+0.25,-0.55) node (c) {};
         \path (eabarplot.west |- survival.north)+(-0.2,1.65) node (d) {};
		 \path (dmr.south -| coxnet.east)+(+0.2,-0.225) node (e) {};
         \path (coxnet.west |- survival.north)+(-0.2,1.65) node (f) {};
         \path[fill=cyan!20,rounded corners, draw=black!50, dashed]
             (a) rectangle (b);
         \path (dmr.west |- clinic.north)+(-0.2,1.0) node (a) {};
         \path (dmr.south -| starburst.east)+(+0.2,-0.3) node (b) {};
         \path[fill = yellow!30,
               rounded corners, 
         	   draw = black!50, dashed]
             (e) rectangle (f);
         \path (clinic.west |- clinic.north)+(0.65,0.3) node (u1)[texto,font=\normalsize]
       {\normalsize{Data functions}};
         \path (survival.north |- dmr.east)+(+0.0,+4.65) node (u1)[texto,font=\normalsize] {\normalsize{Analysis}};
          \path[fill = magenta!20,
                rounded corners, 
                draw = black!50, 
                dashed]
            (d) rectangle (c);
         \path (starburst.north |- starburst.east)+(-0.1,+4.35) node (u1)[texto,font=\normalsize] {\normalsize{Visualize}};
 	\end{pgfonlayer}
 \end{pgfonlayer}

 \end{tikzpicture}
 \end{center}
 \caption[Example of TCGAbiolinks workflow]{Example of a complete workflow using TCGAbiolinks: functions were divided in three groups - data (blue), analysis (yellow) and visualize (green). Green arrows represent expression data, red arrows methylation data and blue arrows clinical data. The function TCGAquery searches for TCGA data using as input the tumor type, platform, level, version of the data and list of samples. The output of TCGAquery will be downloaded with TCGAdownload. TCGAprepare will read the data and prepare the data into a SummarizedExperiment object.%, if save parameter is true the final object is saved. 
 Afterwards, downstream analyses can be performed. For example for methylation data, TCGAanalyze\underline{\space}DMR can be used for Differential methylation analysis. Differential expression analysis can be carried out with TCGAanalyze\_DEA. Integrative visualization of  both results  is possible  using TCGAvisualize\underline{\space}starburst.} 
 \label{NAR-fig3} %flux
 \end{figure}
